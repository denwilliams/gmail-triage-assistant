{{define "prompts"}}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>System Prompts - Gmail Triage Assistant</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
</head>
<body>
	{{template "nav" .}}
	<main class="container">
		<article>
			<h2>System Prompt Configuration</h2>
			<p>Customize the AI prompts that control email processing behavior.</p>
		</article>

		{{range .Prompts}}
		<article>
			<h3>{{.Type}}</h3>
			<form method="POST" action="/prompts/update">
				<input type="hidden" name="type" value="{{.Type}}">
				<label>
					System Prompt
					<textarea name="content" rows="8" required>{{.Content}}</textarea>
					<small>This prompt guides the AI for {{.Type}} operations.</small>
				</label>
				<button type="submit">Update Prompt</button>
			</form>
		</article>
		{{end}}

		{{if not .Prompts}}
		<article>
			<p><em>No prompts configured. Default prompts are being used.</em></p>
			<a href="/prompts/defaults" role="button">Initialize Default Prompts</a>
		</article>
		{{end}}

		{{if or .AIAnalyze .AIActions}}
		<article>
			<h2>AI-Generated Prompt Supplements</h2>
			<p>These are automatically generated weekly and appended to your system prompts. They evolve based on learned patterns.</p>
		</article>

		{{with .AIAnalyze}}
		<article>
			<h3>email_analyze <span style="display: inline-block; background: #28a745; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.75em;">AI v{{.Version}}</span></h3>
			<div style="white-space: pre-wrap; line-height: 1.6; background: var(--pico-card-background-color); padding: 1rem; border-radius: 4px; border-left: 4px solid #28a745;">{{.Content}}</div>
			<p style="color: #888; margin-top: 0.5rem;"><small>Generated: {{.CreatedAt.Format "Jan 2, 2006 3:04 PM"}}</small></p>
		</article>
		{{end}}

		{{with .AIActions}}
		<article>
			<h3>email_actions <span style="display: inline-block; background: #28a745; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.75em;">AI v{{.Version}}</span></h3>
			<div style="white-space: pre-wrap; line-height: 1.6; background: var(--pico-card-background-color); padding: 1rem; border-radius: 4px; border-left: 4px solid #28a745;">{{.Content}}</div>
			<p style="color: #888; margin-top: 0.5rem;"><small>Generated: {{.CreatedAt.Format "Jan 2, 2006 3:04 PM"}}</small></p>
		</article>
		{{end}}
		{{end}}
	</main>
</body>
</html>
{{end}}
