name = "gmail-triage-assistant"
main = "src/index.ts"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

[[d1_databases]]
binding = "DB"
database_name = "gmail-triage"
database_id = "local-test-db"

[[kv_namespaces]]
binding = "SESSIONS"
id = "local-test-sessions"

# Queue: push webhook enqueues here, consumer worker processes async
[[queues.producers]]
queue = "email-processing"
binding = "EMAIL_QUEUE"

[[queues.consumers]]
queue = "email-processing"
max_batch_size = 10
max_batch_timeout = 30
max_retries = 3

[triggers]
crons = [
  "0 8 * * *",
  "0 17 * * *",
  "0 18 * * 6",
  "0 19 1 * *",
  "0 20 1 1 *",
  "0 9 * * *"
]
